{"version":3,"sources":["webpack:///src/app/messages-list/messages-list.page.html","webpack:///src/app/messages-list/messages-list-routing.module.ts","webpack:///src/app/messages-list/messages-list.module.ts","webpack:///src/app/messages-list/messages-list.page.scss","webpack:///src/app/messages-list/messages-list.page.ts"],"names":["routes","path","component","MessagesListPageRoutingModule","imports","forChild","exports","MessagesListPageModule","declarations","MessagesListPage","chatService","route","router","userService","loadingCtrl","users","messages","loading","connectedUser","details","fireBaseUser","JSON","parse","localStorage","getItem","searchedItem","create","present","getChatList","subscribe","value","console","log","forEach","element","uid","findUserByEmail","email","data","getChatMessages","message","from","to","lastMessage","length","push","dismiss","selectedUser","username","user","navigate","event","val","target","trim","filter","item","firstName","toLowerCase","indexOf","selector","template"],"mappings":"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","file":"messages-list-messages-list-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  \\n   <ion-toolbar class=\\\"toolbar\\\" >\\n    <div class=\\\"card-content-2\\\">\\n      <img src={{connectedUser.photo}}>\\n      <p style=\\\"color: rgb(0, 0, 0); font-family: Roboto;\\\">Messages</p>\\n    </div>\\n    <ion-searchbar style=\\\"--border-radius: 15px; --background:rgb(255, 254, 254);\\\" #search showCancelButton=\\\"focus\\\" debounce=\\\"500\\\" (ionChange)=\\\"ionChange($event)\\\"></ion-searchbar>\\n\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content  >\\n  \\n  <ion-list  class=\\\"card-style\\\" *ngFor=\\\"let user of searchedItem\\\" >\\n    <p style=\\\"float: right;margin-top: 30px;font-size: 10px;\\\">{{user.lastMessage !== null && user.lastMessage !== undefined && user.lastMessage.createdAt?.toMillis() | date:'short'}}</p>\\n    <div class=\\\"card-content\\\" (click)=\\\"displayMessages(user)\\\" >\\n      <img src={{user.photo}}>\\n      <ion-label>\\n        <h2>{{user.firstName +\\\" \\\"+user.lastName}}</h2> \\n        <p style=\\\"margin-left: 15px;\\\">{{user.lastMessage !== null && user.lastMessage !== undefined && user.lastMessage.from === user.uid ? '':'You :' }}{{user.lastMessage !== null && user.lastMessage !== undefined ? user.lastMessage.msg : 'Loading...'}} </p>\\n    <!--<p style=\\\"margin-left: 15px;\\\">{{user.lastMessage !== null && user.lastMessage !== undefined && user.lastMessage.isSeen ? 'Seen':'Not seen' }}</p> -->\\n\\n      </ion-label>\\n            \\n    </div>\\n</ion-list>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MessagesListPage } from './messages-list.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MessagesListPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MessagesListPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MessagesListPageRoutingModule } from './messages-list-routing.module';\n\nimport { MessagesListPage } from './messages-list.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MessagesListPageRoutingModule\n  ],\n  declarations: [MessagesListPage]\n})\nexport class MessagesListPageModule {}\n","export default \".card-style {\\n  height: 70px;\\n  width: 350px;\\n  border-radius: 15px;\\n  margin-top: 10px;\\n}\\n\\n.card-content {\\n  position: absolute;\\n  top: 5px;\\n  left: 15px;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.card-content img {\\n  width: 60px;\\n  height: 60px;\\n  border-radius: 50%;\\n  border-color: white;\\n}\\n\\n.card-content h2 {\\n  font-weight: 300;\\n  color: black;\\n  margin-left: 15px;\\n}\\n\\n.card-content p {\\n  font-size: 12px;\\n  color: #aaa4a4;\\n  font-weight: 100;\\n  letter-spacing: 0.4px;\\n  margin-left: 15px;\\n}\\n\\n.card-content-2 {\\n  margin-left: 20px;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.card-content-2 img {\\n  width: 40px;\\n  height: 40px;\\n  border-radius: 50%;\\n  border-color: white;\\n}\\n\\n.card-content-2 h2 {\\n  font-weight: 300;\\n  color: black;\\n  margin-left: 15px;\\n}\\n\\n.card-content-2 p {\\n  font-size: 23px;\\n  color: black;\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n  margin-left: 8px;\\n}\\n\\n.toolbar {\\n  --ion-toolbar-background: #ffffff;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbWVzc2FnZXMtbGlzdC9tZXNzYWdlcy1saXN0LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7RUFDQSxZQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQkFBQTtBQUNKOztBQUVBO0VBRUksa0JBQUE7RUFDQSxRQUFBO0VBQ0EsVUFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtBQUFKOztBQUNJO0VBQ0ksV0FBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0FBQ1I7O0FBQ0k7RUFDSSxnQkFBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtBQUNSOztBQUNJO0VBQ0ksZUFBQTtFQUNBLGNBQUE7RUFDQSxnQkFBQTtFQUNBLHFCQUFBO0VBQ0EsaUJBQUE7QUFDUjs7QUFJQTtFQUVJLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0FBRko7O0FBR0k7RUFDSSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsbUJBQUE7QUFEUjs7QUFHSTtFQUNJLGdCQUFBO0VBQ0EsWUFBQTtFQUNBLGlCQUFBO0FBRFI7O0FBR0k7RUFDSSxlQUFBO0VBQ0EsWUFBQTtFQUNBLGlCQUFBO0VBQ0EscUJBQUE7RUFDQSxnQkFBQTtBQURSOztBQUtBO0VBQ0ksaUNBQUE7QUFGSiIsImZpbGUiOiJzcmMvYXBwL21lc3NhZ2VzLWxpc3QvbWVzc2FnZXMtbGlzdC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY2FyZC1zdHlsZXtcclxuICAgIGhlaWdodDogNzBweDtcclxuICAgIHdpZHRoOiAzNTBweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7XHJcbiAgICBtYXJnaW4tdG9wOiAxMHB4O1xyXG59XHJcblxyXG4uY2FyZC1jb250ZW50e1xyXG4gICBcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIHRvcDogNXB4O1xyXG4gICAgbGVmdDogMTVweDtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgaW1ne1xyXG4gICAgICAgIHdpZHRoOiA2MHB4O1xyXG4gICAgICAgIGhlaWdodDogNjBweDtcclxuICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICAgICAgYm9yZGVyLWNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuICAgIGgye1xyXG4gICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XHJcbiAgICAgICAgY29sb3I6IGJsYWNrO1xyXG4gICAgICAgIG1hcmdpbi1sZWZ0OiAxNXB4O1xyXG4gICAgfVxyXG4gICAgcHtcclxuICAgICAgICBmb250LXNpemU6IDEycHg7XHJcbiAgICAgICAgY29sb3I6ICNhYWE0YTQ7XHJcbiAgICAgICAgZm9udC13ZWlnaHQ6IDEwMDtcclxuICAgICAgICBsZXR0ZXItc3BhY2luZzogMC40cHg7XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDE1cHg7XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuLmNhcmQtY29udGVudC0ye1xyXG4gICBcclxuICAgIG1hcmdpbi1sZWZ0OjIwcHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGltZ3tcclxuICAgICAgICB3aWR0aDogNDBweDtcclxuICAgICAgICBoZWlnaHQ6IDQwcHg7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICAgIGJvcmRlci1jb2xvcjogd2hpdGU7XHJcbiAgICB9XHJcbiAgICBoMntcclxuICAgICAgICBmb250LXdlaWdodDogMzAwO1xyXG4gICAgICAgIGNvbG9yOiBibGFjaztcclxuICAgICAgICBtYXJnaW4tbGVmdDogMTVweDtcclxuICAgIH1cclxuICAgIHB7XHJcbiAgICAgICAgZm9udC1zaXplOiAyM3B4O1xyXG4gICAgICAgIGNvbG9yOiBibGFjaztcclxuICAgICAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgICAgICBsZXR0ZXItc3BhY2luZzogMC40cHg7XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDhweDtcclxuICAgIH1cclxuICAgIFxyXG59XHJcbi50b29sYmFye1xyXG4gICAgLS1pb24tdG9vbGJhci1iYWNrZ3JvdW5kOiAjZmZmZmZmO1xyXG59XHJcblxyXG5cclxuXHJcbiJdfQ== */\";","import { AfterContentInit, Component, OnInit, ViewChild } from '@angular/core';\nimport { IonContent, LoadingController } from '@ionic/angular';\nimport { Observable } from 'rxjs';\nimport { AlertController, IonRouterOutlet, IonSearchbar, ModalController, ToastController } from '@ionic/angular';\nimport { ChatService } from '../Services/chat.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { UserService } from '../Services/user.service';\nimport { AppSettings } from '../Settings/AppSettings';\n\n@Component({\n  selector: 'app-messages-list',\n  templateUrl: './messages-list.page.html',\n  styleUrls: ['./messages-list.page.scss'],\n})\nexport class MessagesListPage implements OnInit {\n  @ViewChild('search', { static: false }) search: IonSearchbar;\n\n  users:any=[];\n  username:any;\n  messages: any=[];\n  connectedUser:any;\n  fireBaseUser:any;\n  searchedItem:any;\n  lastMessage:any ;\n  loading: HTMLIonLoadingElement = null;\n\n  constructor(private chatService: ChatService, private route: ActivatedRoute,private router: Router,private userService:UserService,private loadingCtrl: LoadingController) {\n    \n    this.connectedUser=AppSettings.details;\n    this.fireBaseUser=JSON.parse(localStorage.getItem('fireBaseUser'));  \n    this.searchedItem = this.users\n  }\n\n  async ngOnInit() {\n    this.loading = await this.loadingCtrl.create({});\n    await this.loading.present();\n    \n    this.chatService.getChatList().subscribe((value) => {\n         this.users=[];\n         console.log(value)\n\n         value.forEach(element => {\n         if(element.uid !== JSON.parse(localStorage.getItem('fireBaseUser')).uid){\n         this.userService.findUserByEmail(element.email).subscribe(data=>{\n         element['firstName']=data['firstName'];\n         element['lastName']=data['lastName'];\n         element['username']=data['username']\n         element['photo']=data['photo']\n         element.messages = []\n\n         this.chatService.getChatMessages().subscribe(messages => {\n          messages.forEach(message => {\n            if(message.from === element.uid || message.to === element.uid){\n              element.messages = [...element.messages , message]\n            }\n          })\n          element.lastMessage = element.messages && element.messages.length ? element.messages[element.messages.length - 1] : null\n          console.log(\"last message\",element.lastMessage)\n        })\n        })\n        this.users.push(element);\n        this.searchedItem = this.users\n      }\n       });\n      });\n      \n      this.chatService.getChatMessages().subscribe(data=>{\n        console.log(data)\n         this.messages=[];\n         data.forEach(element => {\n           if((element['from'] === this.fireBaseUser.uid)){\n            this.messages.push(element)\n            console.log(this.messages)\n             this.lastMessage = this.messages[this.messages.length-1];  \n                 }\n         });\n         this.loading.dismiss();\n         this.loading = null;\n      })\n     \n  }\n\n  displayMessages(selectedUser){\n    console.log(selectedUser)\n    this.userService.details(selectedUser.username).subscribe(user => {\n      console.log('details', user);\n     this.router.navigate(['/messages',selectedUser.uid]);\n      }\n    )}\n    \n    ionChange(event){\n      const val = event.target.value;\n      this.searchedItem = this.users;\n      if (val && val.trim() != '') {\n        this.searchedItem = this.searchedItem.filter((item: any) => {\n          console.log(item.firstName)\n          return (item.firstName.toLowerCase().indexOf(val.toLowerCase()) > -1);\n        })\n      }\n    }\n\n}\n"]}